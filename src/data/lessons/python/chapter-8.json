{
  "chapterId": "py_ch_008",
  "title": "List Comprehensions",
  "subtitle": "Cr√©e des listes en une ligne avec une syntaxe puissante",
  "sections": [
    {
      "id": "section_1",
      "type": "text",
      "title": "Qu'est-ce qu'une list comprehension ?",
      "content": "Une **list comprehension** est une syntaxe Python **concise** pour cr√©er des listes. En une seule ligne, tu peux transformer, filtrer et g√©n√©rer des listes de fa√ßon tr√®s lisible.\n\nC'est un pattern **tr√®s utilis√©** dans du code Python professionnel !"
    },
    {
      "id": "section_2",
      "type": "code_example",
      "language": "python",
      "code": "# M√©thode classique avec boucle\ncarres = []\nfor i in range(5):\n    carres.append(i ** 2)\n\nprint(carres)  # [0, 1, 4, 9, 16]\n\n# List comprehension (√©quivalent en 1 ligne)\ncarres = [i ** 2 for i in range(5)]\nprint(carres)  # [0, 1, 4, 9, 16]",
      "caption": "Boucle classique vs list comprehension",
      "highlight": {
        "style": "info",
        "content": "üí° **Astuce** : La syntaxe est `[expression for element in iterable]`. Lis-la comme : \"Pour chaque `element` dans `iterable`, cr√©e `expression`\"."
      }
    },
    {
      "id": "section_3",
      "type": "exercise",
      "exerciseId": "py_ch8_ex1"
    },
    {
      "id": "section_4",
      "type": "text",
      "title": "Transformer des donn√©es",
      "content": "Les list comprehensions sont parfaites pour **transformer** chaque √©l√©ment d'une liste. Tu peux appliquer n'importe quelle op√©ration ou fonction :"
    },
    {
      "id": "section_5",
      "type": "code_example",
      "language": "python",
      "code": "# Convertir des temp√©ratures Celsius en Fahrenheit\ncelsius = [0, 10, 20, 30, 40]\nfahrenheit = [(c * 9/5) + 32 for c in celsius]\nprint(fahrenheit)  # [32.0, 50.0, 68.0, 86.0, 104.0]\n\n# Mettre des mots en majuscules\nmots = [\"python\", \"java\", \"c++\"]\nmajuscules = [mot.upper() for mot in mots]\nprint(majuscules)  # ['PYTHON', 'JAVA', 'C++']",
      "caption": "Transformer des listes avec comprehensions",
      "highlight": {
        "style": "success",
        "content": "‚úÖ **Cas d'usage r√©el** : Transformer des donn√©es venant d'une API (ex: convertir tous les prix en euros vers dollars)."
      }
    },
    {
      "id": "section_6",
      "type": "exercise",
      "exerciseId": "py_ch8_ex2"
    },
    {
      "id": "section_7",
      "type": "text",
      "title": "Filtrer avec une condition",
      "content": "Tu peux ajouter un `if` √† la fin pour **filtrer** les √©l√©ments. Seuls ceux qui respectent la condition seront inclus dans la nouvelle liste.\n\nSyntaxe : `[expression for element in iterable if condition]`"
    },
    {
      "id": "section_8",
      "type": "code_example",
      "language": "python",
      "code": "# Garder seulement les nombres pairs\nnombres = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\npairs = [n for n in nombres if n % 2 == 0]\nprint(pairs)  # [2, 4, 6, 8, 10]\n\n# Filtrer des mots de plus de 3 lettres\nmots = [\"je\", \"suis\", \"un\", \"dev\", \"Python\"]\nlongs = [mot for mot in mots if len(mot) > 3]\nprint(longs)  # ['suis', 'Python']",
      "caption": "Filtrer des listes avec une condition",
      "highlight": {
        "style": "warning",
        "content": "‚ö†Ô∏è **Attention** : Le `if` de filtrage est **√† la fin**, pas au d√©but ! Ne confonds pas avec l'op√©rateur ternaire `x if condition else y`."
      }
    },
    {
      "id": "section_9",
      "type": "exercise",
      "exerciseId": "py_ch8_ex3"
    },
    {
      "id": "section_10",
      "type": "text",
      "title": "Transformer ET filtrer",
      "content": "Tu peux **combiner** transformation et filtrage en une seule comprehension :\n\nSyntaxe : `[expression for element in iterable if condition]`"
    },
    {
      "id": "section_11",
      "type": "code_example",
      "language": "python",
      "code": "# Carr√©s des nombres pairs seulement\nnombres = [1, 2, 3, 4, 5, 6]\ncarres_pairs = [n ** 2 for n in nombres if n % 2 == 0]\nprint(carres_pairs)  # [4, 16, 36]\n\n# Longueurs des mots de plus de 4 lettres\nmots = [\"chat\", \"chien\", \"oiseau\", \"rat\"]\nlongueurs = [len(mot) for mot in mots if len(mot) > 4]\nprint(longueurs)  # [5, 6]",
      "caption": "Combiner transformation et filtrage",
      "highlight": {
        "style": "info",
        "content": "üí° **Astuce** : Lis la comprehension de gauche √† droite : \"Prends `n ** 2` pour chaque `n` dans `nombres` si `n` est pair\"."
      }
    },
    {
      "id": "section_12",
      "type": "text",
      "title": "Expressions conditionnelles (if-else)",
      "content": "Pour un `if-else` **dans l'expression** (pas en filtrage), utilise l'op√©rateur ternaire :\n\nSyntaxe : `[expression_si_vrai if condition else expression_si_faux for element in iterable]`"
    },
    {
      "id": "section_13",
      "type": "code_example",
      "language": "python",
      "code": "# Remplacer les n√©gatifs par 0\nnombres = [-2, 5, -8, 10, -1]\npositifs = [n if n > 0 else 0 for n in nombres]\nprint(positifs)  # [0, 5, 0, 10, 0]\n\n# Cat√©goriser pair/impair\nnombres = [1, 2, 3, 4, 5]\ncategories = [\"pair\" if n % 2 == 0 else \"impair\" for n in nombres]\nprint(categories)  # ['impair', 'pair', 'impair', 'pair', 'impair']",
      "caption": "if-else dans l'expression",
      "highlight": {
        "style": "error",
        "content": "üö® **Pi√®ge courant** : L'ordre est diff√©rent !\n\n‚Ä¢ Filtrage : `[expr for x in list if condition]` (if √† la fin)\n‚Ä¢ if-else : `[expr_if if cond else expr_else for x in list]` (if au milieu)"
      }
    },
    {
      "id": "section_14",
      "type": "exercise",
      "exerciseId": "py_ch8_ex4"
    },
    {
      "id": "section_15",
      "type": "text",
      "title": "Comprehensions imbriqu√©es",
      "content": "Tu peux imbriquer des boucles dans une comprehension pour cr√©er des listes √† partir de **plusieurs it√©rables** :"
    },
    {
      "id": "section_16",
      "type": "code_example",
      "language": "python",
      "code": "# Table de multiplication 3x3\ntable = [(i, j, i*j) for i in range(1, 4) for j in range(1, 4)]\nprint(table)\n# [(1,1,1), (1,2,2), (1,3,3), (2,1,2), (2,2,4), ...]\n\n# Aplatir une liste de listes\nmatrice = [[1, 2], [3, 4], [5, 6]]\naplatie = [element for ligne in matrice for element in ligne]\nprint(aplatie)  # [1, 2, 3, 4, 5, 6]",
      "caption": "Comprehensions imbriqu√©es",
      "highlight": {
        "style": "warning",
        "content": "‚ö†Ô∏è **Attention** : Les comprehensions imbriqu√©es peuvent devenir illisibles. Si c'est trop complexe, utilise des boucles normales !"
      }
    },
    {
      "id": "section_17",
      "type": "exercise",
      "exerciseId": "py_ch8_ex5"
    },
    {
      "id": "section_18",
      "type": "text",
      "title": "R√©capitulatif",
      "content": "üéØ **Ce que tu as appris :**\n\n‚Ä¢ Syntaxe de base : `[expr for x in list]`\n‚Ä¢ Transformer des donn√©es avec des expressions\n‚Ä¢ Filtrer avec `if` √† la fin\n‚Ä¢ Combiner transformation ET filtrage\n‚Ä¢ if-else dans l'expression (op√©rateur ternaire)\n‚Ä¢ Comprehensions imbriqu√©es (avec mod√©ration)\n\n**Prochaine √©tape :** Tu vas d√©couvrir la **Programmation Orient√©e Objet (POO)** pour structurer ton code avec des classes !"
    }
  ],
  "exercises": [
    {
      "id": "py_ch8_ex1",
      "type": "predict_output",
      "inputType": "options",
      "question": "Que va cr√©er cette list comprehension ?",
      "code": "doubles = [x * 2 for x in [1, 2, 3]]\nprint(doubles)",
      "options": ["[1, 2, 3]", "[2, 4, 6]", "[1, 1, 2, 2, 3, 3]", "[3, 6, 9]"],
      "correctAnswer": 1,
      "explanation": "Pour chaque `x` dans `[1, 2, 3]`, on calcule `x * 2`. R√©sultat : **[2, 4, 6]**.",
      "highlightedLines": [1],
      "xpGain": 10
    },
    {
      "id": "py_ch8_ex2",
      "type": "predict_output",
      "inputType": "free_input",
      "question": "Combien d'√©l√©ments contient cette liste ?",
      "code": "nombres = [10, 20, 30, 40]\nmoities = [n / 2 for n in nombres]\nprint(len(moities))",
      "predefinedAnswers": ["2", "4", "8", "10"],
      "correctAnswer": "4",
      "explanation": "La comprehension cr√©e un nouvel √©l√©ment pour **chaque** √©l√©ment de la liste originale. Il y a donc **4 √©l√©ments** : [5.0, 10.0, 15.0, 20.0].",
      "highlightedLines": [2],
      "xpGain": 10
    },
    {
      "id": "py_ch8_ex3",
      "type": "predict_output",
      "inputType": "options",
      "question": "Que va afficher ce code ?",
      "code": "nombres = [1, 2, 3, 4, 5, 6]\nimpairs = [n for n in nombres if n % 2 != 0]\nprint(impairs)",
      "options": ["[1, 3, 5]", "[2, 4, 6]", "[1, 2, 3]", "[1, 2, 3, 4, 5, 6]"],
      "correctAnswer": 0,
      "explanation": "Le `if n % 2 != 0` filtre pour garder seulement les nombres **impairs** : **[1, 3, 5]**.",
      "highlightedLines": [2],
      "xpGain": 10
    },
    {
      "id": "py_ch8_ex4",
      "type": "predict_output",
      "inputType": "options",
      "question": "Que va cr√©er cette comprehension ?",
      "code": "nombres = [-1, 2, -3, 4]\nabsolus = [n if n >= 0 else -n for n in nombres]\nprint(absolus)",
      "options": ["[-1, 2, -3, 4]", "[1, 2, 3, 4]", "[1, -2, 3, -4]", "Erreur"],
      "correctAnswer": 1,
      "explanation": "L'op√©rateur ternaire `n if n >= 0 else -n` convertit les n√©gatifs en positifs (valeur absolue). R√©sultat : **[1, 2, 3, 4]**.",
      "highlightedLines": [2],
      "xpGain": 10
    },
    {
      "id": "py_ch8_ex5",
      "type": "predict_output",
      "inputType": "free_input",
      "question": "Combien d'√©l√©ments contient cette liste aplatie ?",
      "code": "listes = [[1, 2], [3, 4, 5], [6]]\naplatie = [x for liste in listes for x in liste]\nprint(len(aplatie))",
      "predefinedAnswers": ["3", "4", "6", "8"],
      "correctAnswer": "6",
      "explanation": "La comprehension parcourt chaque sous-liste et extrait chaque √©l√©ment. Total : 2 + 3 + 1 = **6 √©l√©ments**.",
      "highlightedLines": [2],
      "xpGain": 10
    }
  ]
}
