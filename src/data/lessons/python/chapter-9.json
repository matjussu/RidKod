{
  "chapterId": "py_ch_009",
  "title": "POO - Bases",
  "subtitle": "D√©couvre la Programmation Orient√©e Objet avec les classes",
  "sections": [
    {
      "id": "section_1",
      "type": "text",
      "title": "Qu'est-ce que la POO ?",
      "content": "La **Programmation Orient√©e Objet (POO)** est un paradigme qui organise le code autour d'**objets**. Un objet regroupe des **donn√©es** (attributs) et des **comportements** (m√©thodes).\n\nC'est comme une recette : une **classe** est le mod√®le, un **objet** est un g√¢teau cr√©√© avec ce mod√®le !"
    },
    {
      "id": "section_2",
      "type": "code_example",
      "language": "python",
      "code": "# D√©finir une classe\nclass Voiture:\n    pass  # Classe vide pour l'instant\n\n# Cr√©er un objet (instance)\nma_voiture = Voiture()\nprint(type(ma_voiture))  # <class '__main__.Voiture'>",
      "caption": "Cr√©er une classe simple",
      "highlight": {
        "style": "info",
        "content": "üí° **Astuce** : Par convention, les noms de classes commencent par une **majuscule** (ex: `Voiture`, `Personne`, `JeuVideo`)."
      }
    },
    {
      "id": "section_3",
      "type": "exercise",
      "exerciseId": "py_ch9_ex1"
    },
    {
      "id": "section_4",
      "type": "text",
      "title": "Le constructeur __init__",
      "content": "La m√©thode sp√©ciale `__init__` est le **constructeur**. Elle est appel√©e automatiquement quand tu cr√©es un objet et permet d'initialiser ses attributs.\n\nLe param√®tre `self` repr√©sente l'**instance elle-m√™me** (√©quivalent de `this` en Java/JavaScript)."
    },
    {
      "id": "section_5",
      "type": "code_example",
      "language": "python",
      "code": "class Personne:\n    def __init__(self, nom, age):\n        self.nom = nom\n        self.age = age\n\n# Cr√©er des instances\nalice = Personne(\"Alice\", 25)\nbob = Personne(\"Bob\", 30)\n\nprint(alice.nom)  # Alice\nprint(bob.age)    # 30",
      "caption": "Initialiser des attributs avec __init__",
      "highlight": {
        "style": "warning",
        "content": "‚ö†Ô∏è **Attention** : Le premier param√®tre de **toutes** les m√©thodes de classe doit √™tre `self` (sauf pour les m√©thodes statiques)."
      }
    },
    {
      "id": "section_6",
      "type": "exercise",
      "exerciseId": "py_ch9_ex2"
    },
    {
      "id": "section_7",
      "type": "text",
      "title": "Les attributs d'instance",
      "content": "Les **attributs d'instance** sont des variables propres √† chaque objet. Ils sont cr√©√©s avec `self.nom_attribut` dans `__init__` ou dans d'autres m√©thodes.\n\nChaque instance a ses propres valeurs d'attributs !"
    },
    {
      "id": "section_8",
      "type": "code_example",
      "language": "python",
      "code": "class CompteBancaire:\n    def __init__(self, proprietaire, solde):\n        self.proprietaire = proprietaire\n        self.solde = solde\n\ncompte1 = CompteBancaire(\"Alice\", 1000)\ncompte2 = CompteBancaire(\"Bob\", 500)\n\nprint(compte1.solde)  # 1000\nprint(compte2.solde)  # 500 (diff√©rent !)",
      "caption": "Chaque instance a ses propres attributs",
      "highlight": {
        "style": "success",
        "content": "‚úÖ **Cas d'usage r√©el** : Dans un jeu vid√©o, chaque personnage (instance de la classe `Personnage`) a sa propre sant√©, position, inventaire, etc."
      }
    },
    {
      "id": "section_9",
      "type": "text",
      "title": "Les m√©thodes d'instance",
      "content": "Les **m√©thodes** sont des fonctions d√©finies dans une classe. Elles permettent de d√©finir les **comportements** d'un objet.\n\nElles prennent toujours `self` comme premier param√®tre pour acc√©der aux attributs de l'instance."
    },
    {
      "id": "section_10",
      "type": "code_example",
      "language": "python",
      "code": "class Rectangle:\n    def __init__(self, largeur, hauteur):\n        self.largeur = largeur\n        self.hauteur = hauteur\n    \n    def aire(self):\n        return self.largeur * self.hauteur\n    \n    def perimetre(self):\n        return 2 * (self.largeur + self.hauteur)\n\nrect = Rectangle(5, 3)\nprint(rect.aire())       # 15\nprint(rect.perimetre())  # 16",
      "caption": "D√©finir des m√©thodes pour calculer des valeurs",
      "highlight": {
        "style": "info",
        "content": "üí° **Astuce** : Les m√©thodes permettent d'**encapsuler** la logique. Au lieu de calculer l'aire manuellement, tu appelles simplement `rect.aire()`."
      }
    },
    {
      "id": "section_11",
      "type": "exercise",
      "exerciseId": "py_ch9_ex3"
    },
    {
      "id": "section_12",
      "type": "text",
      "title": "Modifier les attributs",
      "content": "Tu peux modifier les attributs d'un objet soit **directement**, soit via des **m√©thodes** (recommand√© pour plus de contr√¥le) :"
    },
    {
      "id": "section_13",
      "type": "code_example",
      "language": "python",
      "code": "class CompteBancaire:\n    def __init__(self, solde):\n        self.solde = solde\n    \n    def deposer(self, montant):\n        self.solde += montant\n    \n    def retirer(self, montant):\n        if montant <= self.solde:\n            self.solde -= montant\n        else:\n            print(\"Solde insuffisant\")\n\ncompte = CompteBancaire(100)\ncompte.deposer(50)\nprint(compte.solde)  # 150\ncompte.retirer(200)  # \"Solde insuffisant\"",
      "caption": "Modifier les attributs via des m√©thodes",
      "highlight": {
        "style": "success",
        "content": "‚úÖ **Bonne pratique** : Utilise des m√©thodes pour modifier les attributs plut√¥t que l'acc√®s direct (`compte.solde = 1000`). Cela permet de valider les donn√©es."
      }
    },
    {
      "id": "section_14",
      "type": "exercise",
      "exerciseId": "py_ch9_ex4"
    },
    {
      "id": "section_15",
      "type": "text",
      "title": "Les attributs de classe",
      "content": "Les **attributs de classe** sont partag√©s par **toutes les instances**. Ils sont d√©finis directement dans la classe, pas dans `__init__`.\n\nUtiles pour des constantes ou des compteurs globaux !"
    },
    {
      "id": "section_16",
      "type": "code_example",
      "language": "python",
      "code": "class Joueur:\n    nombre_joueurs = 0  # Attribut de classe\n    \n    def __init__(self, nom):\n        self.nom = nom  # Attribut d'instance\n        Joueur.nombre_joueurs += 1\n\nj1 = Joueur(\"Alice\")\nj2 = Joueur(\"Bob\")\nj3 = Joueur(\"Charlie\")\n\nprint(Joueur.nombre_joueurs)  # 3\nprint(j1.nombre_joueurs)      # 3 (accessible aussi via instance)",
      "caption": "Attributs de classe vs attributs d'instance",
      "highlight": {
        "style": "warning",
        "content": "‚ö†Ô∏è **Attention** : Pour modifier un attribut de classe, utilise `NomClasse.attribut`, pas `self.attribut` (qui cr√©erait un attribut d'instance)."
      }
    },
    {
      "id": "section_17",
      "type": "text",
      "title": "La m√©thode __str__ (repr√©sentation)",
      "content": "La m√©thode sp√©ciale `__str__` d√©finit comment un objet est affich√© avec `print()`. C'est comme un \"mode d'affichage humain\" de ton objet."
    },
    {
      "id": "section_18",
      "type": "code_example",
      "language": "python",
      "code": "class Livre:\n    def __init__(self, titre, auteur):\n        self.titre = titre\n        self.auteur = auteur\n    \n    def __str__(self):\n        return f\"'{self.titre}' par {self.auteur}\"\n\nlivre = Livre(\"1984\", \"George Orwell\")\nprint(livre)  # '1984' par George Orwell\n\n# Sans __str__, afficherait :\n# <__main__.Livre object at 0x...>",
      "caption": "Personnaliser l'affichage avec __str__",
      "highlight": {
        "style": "info",
        "content": "üí° **Astuce** : D√©finis toujours `__str__` pour rendre tes objets lisibles lors du debugging avec `print()`."
      }
    },
    {
      "id": "section_19",
      "type": "exercise",
      "exerciseId": "py_ch9_ex5"
    },
    {
      "id": "section_20",
      "type": "text",
      "title": "H√©ritage : les bases",
      "content": "L'**h√©ritage** permet de cr√©er une classe **enfant** qui h√©rite des attributs et m√©thodes d'une classe **parent**.\n\nSyntaxe : `class Enfant(Parent):`"
    },
    {
      "id": "section_21",
      "type": "code_example",
      "language": "python",
      "code": "class Animal:\n    def __init__(self, nom):\n        self.nom = nom\n    \n    def parler(self):\n        return \"...\"\n\nclass Chien(Animal):\n    def parler(self):  # Surcharge (override)\n        return \"Woof!\"\n\nclass Chat(Animal):\n    def parler(self):\n        return \"Miaou!\"\n\nchien = Chien(\"Rex\")\nchat = Chat(\"F√©lix\")\nprint(chien.parler())  # Woof!\nprint(chat.parler())   # Miaou!",
      "caption": "H√©ritage et surcharge de m√©thodes",
      "highlight": {
        "style": "success",
        "content": "‚úÖ **Cas d'usage r√©el** : Dans un jeu, une classe `Personnage` peut √™tre parent de `Guerrier`, `Mage`, `Archer`, chacun avec ses propres comp√©tences."
      }
    },
    {
      "id": "section_22",
      "type": "exercise",
      "exerciseId": "py_ch9_ex6"
    },
    {
      "id": "section_23",
      "type": "text",
      "title": "R√©capitulatif",
      "content": "üéØ **Ce que tu as appris :**\n\n‚Ä¢ Cr√©er des **classes** avec `class NomClasse:`\n‚Ä¢ Initialiser avec le constructeur `__init__(self, ...)`\n‚Ä¢ D√©finir des **attributs** (`self.attribut`)\n‚Ä¢ Cr√©er des **m√©thodes** (fonctions de classe)\n‚Ä¢ Attributs de classe vs attributs d'instance\n‚Ä¢ Personnaliser l'affichage avec `__str__`\n‚Ä¢ Bases de l'**h√©ritage** et surcharge\n\n**Prochaine √©tape :** Tu vas apprendre √† **g√©rer les erreurs** proprement avec try/except pour cr√©er des programmes robustes !"
    }
  ],
  "exercises": [
    {
      "id": "py_ch9_ex1",
      "type": "concept_understanding",
      "inputType": "options",
      "question": "Qu'est-ce qu'une instance ?",
      "code": "class Voiture:\n    pass\n\nma_voiture = Voiture()",
      "options": ["La classe Voiture", "La variable ma_voiture", "Un objet cr√©√© √† partir de la classe", "Une m√©thode"],
      "correctAnswer": 2,
      "explanation": "`ma_voiture` est une **instance** (objet concret) cr√©√©e √† partir du mod√®le (classe) `Voiture`.",
      "highlightedLines": [4],
      "xpGain": 10
    },
    {
      "id": "py_ch9_ex2",
      "type": "predict_output",
      "inputType": "options",
      "question": "Que va afficher ce code ?",
      "code": "class Personne:\n    def __init__(self, nom):\n        self.nom = nom\n\np = Personne(\"Alice\")\nprint(p.nom)",
      "options": ["Personne", "Alice", "nom", "Erreur"],
      "correctAnswer": 1,
      "explanation": "Le constructeur `__init__` initialise `self.nom` avec la valeur `\"Alice\"`. L'attribut `p.nom` vaut donc **Alice**.",
      "highlightedLines": [2, 3, 6],
      "xpGain": 10
    },
    {
      "id": "py_ch9_ex3",
      "type": "predict_output",
      "inputType": "free_input",
      "question": "Que va retourner l'appel de la m√©thode ?",
      "code": "class Calcul:\n    def __init__(self, x):\n        self.x = x\n    \n    def doubler(self):\n        return self.x * 2\n\nc = Calcul(7)\nprint(c.doubler())",
      "predefinedAnswers": ["7", "14", "2", "9"],
      "correctAnswer": "14",
      "explanation": "La m√©thode `doubler()` retourne `self.x * 2`. Avec `x = 7`, le r√©sultat est `7 * 2 = 14`.",
      "highlightedLines": [5, 6, 9],
      "xpGain": 10
    },
    {
      "id": "py_ch9_ex4",
      "type": "trace_execution",
      "inputType": "free_input",
      "question": "Quelle est la valeur de compte.solde apr√®s ces op√©rations ?",
      "code": "class Compte:\n    def __init__(self):\n        self.solde = 0\n    \n    def ajouter(self, montant):\n        self.solde += montant\n\ncompte = Compte()\ncompte.ajouter(50)\ncompte.ajouter(30)\nprint(compte.solde)",
      "predefinedAnswers": ["0", "30", "50", "80"],
      "correctAnswer": "80",
      "explanation": "Le solde part de 0, puis on ajoute 50 (total 50), puis 30 (total **80**).",
      "highlightedLines": [5, 6, 9, 10],
      "xpGain": 10
    },
    {
      "id": "py_ch9_ex5",
      "type": "find_error",
      "inputType": "clickable_lines",
      "question": "Ce code devrait compter les instances cr√©√©es, mais le compteur ne s'incr√©mente pas. Quelle ligne contient l'erreur ?",
      "code": "class Produit:\n    total = 0\n    \n    def __init__(self, nom):\n        self.nom = nom\n        self.total += 1",
      "correctAnswer": 5,
      "explanation": "Ligne 6 : `self.total += 1` cr√©e un **attribut d'instance** au lieu de modifier l'attribut de classe. Il faut √©crire `Produit.total += 1`.",
      "highlightedLines": [6],
      "xpGain": 10
    },
    {
      "id": "py_ch9_ex6",
      "type": "predict_output",
      "inputType": "options",
      "question": "Que va afficher ce code avec h√©ritage ?",
      "code": "class Animal:\n    def crier(self):\n        return \"...\"\n\nclass Chien(Animal):\n    def crier(self):\n        return \"Woof\"\n\nd = Chien()\nprint(d.crier())",
      "options": ["...", "Woof", "Animal", "Erreur"],
      "correctAnswer": 1,
      "explanation": "La classe `Chien` **surcharge** la m√©thode `crier()` de la classe parent. L'instance utilise la version de la classe enfant : **Woof**.",
      "highlightedLines": [6, 7, 10],
      "xpGain": 10
    }
  ]
}
